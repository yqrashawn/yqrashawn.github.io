  <!DOCTYPE html>
  <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
  <meta charset="UTF-8">

  <meta name="author" content="yqrashawn" />
  <meta name="generator" content="lazyblorg" />
  <meta name="description" content="Fix The Log Folder Permission Problem with Homebrew Services" />
  <meta name="orgmode-id" content="2018-09-29-brew-services-log-permission-probelm" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@yqrashawn" />
  <meta name="twitter:creator" content="@yqrashawn" />
  <meta name="twitter:title" content="infin" />
  <meta name="twitter:description" content="Fix The Log Folder Permission Problem with Homebrew Services" />
  <meta name="twitter:image" content="//yqrashawn.com/public/img/YQ_logo.png" />

  <meta property="og:type" content="article" />
  <meta property="og:title" content="infin" />
  <meta property="og:description" content="Fix The Log Folder Permission Problem with Homebrew Services" />
  <meta property="og:image" content="//yqrashawn.com/public/img/YQ_logo.png" />
  <meta property="og:site_name" content="infin - Web-page of yqrashawn">
  <meta property="article:published_time" content="2018-09-29T18:26+08:00" />
  <meta property="article:author" content="yqrashawn" />

  <link rel="stylesheet" title="infin Standard CSS Style"
        href="//yqrashawn.com/public/css/YQ.css" type="text/css" media="screen"  />

  <link rel="alternate" type="application/atom+xml"
        title="infin (links only)" href="//yqrashawn.com/feeds/lazyblorg-all.atom_1.0.links-only.xml" />
  <link rel="alternate" type="application/atom+xml"
        title="infin (article teasers)" href="//yqrashawn.com/feeds/lazyblorg-all.atom_1.0.links-and-teaser.xml" />
  <link rel="alternate" type="application/atom+xml"
        title="infin (full content)" href="//yqrashawn.com/feeds/lazyblorg-all.atom_1.0.links-and-content.xml" />
  <script type="text/javascript" src="//yqrashawn.com/public/js/highlight.pack.js"></script>
  <script type="text/javascript" src="//yqrashawn.com/public/js/menu.js"></script>

  <!-- WARNING: This page is written in HTML5 and might not be displayed correctly in old browsers. -->

      <!-- link rel="stylesheet" type="text/css" href="../../../../style.css" / -->
      <title>Fix The Log Folder Permission Problem with Homebrew Services</title>

  </head>  <body>



	<header>

	  <nav class="temporal-article-header-nav">
	    <span class="breadcrumbs">
	      <a href="../../../../">infin</a><span style="padding-top:1em;">&nbsp;&nbsp;&nbsp;&nbsp;&raquo;
	      <a href="../../../">2018</a>&nbsp;&ndash;&nbsp;<a href="../../">09</a>&nbsp;&ndash;&nbsp;<a href="../">29</a></span>
	    </span>
	  </nav>
	  <aside class="common-tags">
	    <ul>
                <li><a class="usertag" href="//yqrashawn.com/tags/macos/">macos</a></li>
                <li><a class="usertag" href="//yqrashawn.com/tags/tool/">tool</a></li>
	    </ul>
	  </aside>

	  <h1 class="common-article-header-title">Fix The Log Folder Permission Problem with Homebrew Services</h1>

	</header>

  
  <div class="menu-espanso">
    <div id="menu-group">
      <div id="menu" class="menu">
      <div id="menu-in" class="menu-in"></div>
      </div>
      <span class="menu-closer"></span>
      <span class="linee linea1"></span>
      <span class="linee linea2"></span>
      <span class="linee linea3"></span>
    </div>
    <div class="voci-menu">
      <ul>
         <a id="show-sidebar-text" href="#show-sidebar">Show Sidebar</a>
         <div class="sidebar toggle-sidebar">


           <ul>
           <li><a href="../../../../about">About</a></li>
           <li><a href="//duckduckgo.com/?q=site%3A+yqrashawn.com+++">Search infin</li>
           <li>Subscribe</li>
               <ul>
               <li><span style="font-size:small"><a href="//yqrashawn.com/feeds/lazyblorg-all.atom_1.0.links-only.xml">links only</a> (most reliable)</span></li>
               <li><span style="font-size:small"><a href="//yqrashawn.com/feeds/lazyblorg-all.atom_1.0.links-and-teaser.xml">article teaser</a></span></li>
               <li><span style="font-size:small"><a href="//yqrashawn.com/feeds/lazyblorg-all.atom_1.0.links-and-content.xml">full content</a></span></li>
               </ul>
           <li id="top-tags">Top <a href="//yqrashawn.com/tags/">tags</a>:</li>
               <ul class="top-tags-list">
                     
              <li><a class="usertag" href="//yqrashawn.com/tags/emacs">emacs</a> (8)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/tool">tool</a> (3)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/karabiner">karabiner</a> (3)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/macos">macos</a> (3)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/workspace">workspace</a> (2)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/coding">coding</a> (2)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/efficient">efficient</a> (2)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/watching">watching</a> (1)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/ruby">ruby</a> (1)</li>
              <li><a class="usertag" href="//yqrashawn.com/tags/agenda">agenda</a> (1)</li>
               </ul>
           </ul>
         </div>
      </ul>
    </div>
  </div>



  <article class="common-article">

<p>

Recently I'm developing this <a href="https://github.com/yqrashawn/GokuRakuJoudo">GokuRakuJoudo</a> tool to enable user config <a href="https://pqrs.org/osx/karabiner/">karabiner</a> with <a href="https://github.com/edn-format/edn">edn</a> file instead of json file.

</p>

<p>

I deploy it to the macOS package manager homebrew so that user can install it with homebrew easily. Since the tool is used to watch the edn file and transform it to json file. It's naturally to use homebrew services to run the command.

</p>

<p>

Homebrew services uses macOS's launchctl tool to read plist file and run service. The problem is launchctl create the log directory I set in the plist file with system permission, and the program don't need to run under system permission. So the service failed.

</p>
<div class="orgmode-hr" ></div>
<p>

I tried to find ways to create the directory in the brew formula file. But it seems one can't get the HOME env variable in the <code>def install</code> section of the formula. So that I can't create the ~<code>/Library/Logs/goku</code> folder with user ownership. I checked other packages like redis and mongodb. But they all need to run with <code>sudo brew services start</code>.

</p>

<p>

When I was about to give up and tell user to create the folder themselves before install the package. I saw there're many other .log files under ~<code>/Library/Logs</code> directory. Then I changed the log file location from <code>...Logs/goku/output.log</code> to <code>.../Logs/goku.log</code>. It works! User do have write permission to file <code>goku.log</code>. It seems that launchctl only create folders with system owner group instead of files. Wired problem. Hope this may help people encountered with the same problem.

</p>


  </article>
	  <aside class="published-on">
	    Published on <time datetime="2018-09-29T18:26+08:00">2018-09-29T18:26</time>
	  </aside>

   <p class="email-comment">
      <a href="mailto:hi@yqrashawn.com?subject=2018-09-29-brew-services-log-permission-probelm%20comment:%20&body=Please%20do%20not%20remove%20'2018-09-29-brew-services-log-permission-probelm%20comment:'%20in%20subject%20and%20please%20tell%20me%20whether%20or%20not%20it%20is%20OK%20to%20add%20your%20comment%20and%2For%20your%20email%20address%20to%20the%20blog%20entry!">Comment via email</a> or via <a href="//disqus.com">Disqus</a> comments below:
   </p>

    <div id="disqus_thread"></div>
    <div id="disqus_loader" style="text-align: center">
      <!-- stolen from http://blog.yjl.im/2012/04/let-your-readers-decide-when-to-load.html -->
      <button onclick="load_disqus()">Load Disqus Comments</button>
      <script>
        function load_disqus()
        {
          var dsq = document.createElement('script');
          dsq.type = 'text/javascript';
          dsq.async = true;
          dsq.src = "//yqrashawn.disqus.com/embed.js";
          var disqus_identifier = '2018-09-29-brew-services-log-permission-probelm';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          var ldr = document.getElementById('disqus_loader');
          ldr.parentNode.removeChild(ldr);
        }
      </script>
    </div>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">Disqus comments.</a></noscript>

    <footer>
      <p><i><a href="../../../../about">infin</a></i> is authored in <a href="//orgmode.org">Org-mode</a> and generated by <a href="https://github.com/novoid/lazyblorg">lazyblorg</a>

	 	&nbsp;&bull;&nbsp; <a href="//github.com/yqrashawn">Github</a>

	 	&nbsp;&bull;&nbsp; <a href="mailto:hi@yqrashawn.com">Mail</a>

	 	&nbsp;&bull;&nbsp; <a href="https://web.archive.org/web/*/yqrashawn.com/2018/09/29/brew-services-log-permission-probelm/">Archive</a>
      </p>
    </footer>

  </body>
</html>